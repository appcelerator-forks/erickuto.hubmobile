function removeTag(e){removeFromArray(selectedTagOptions,e),loadSelectedTags()}function clearSearchBar(){txtAutoComplete.blur(),txtAutoComplete.value="",txtAutoComplete.hide(),txtAutoComplete.show()}function removeFromArray(e){var t,n=arguments,r=n.length,i;while(r>1&&e.length){t=n[--r];while((i=e.indexOf(t))!==-1)e.splice(i,1)}return e}function loadSelectedTags(){dataHolder.remove(selectedTags),selectedTags=Ti.UI.createView({layout:"horizontal"});for(var e=0;e<selectedTagOptions.length;e++)tagIcon=createTag(selectedTagOptions[e]),selectedTags.add(tagIcon);dataHolder.add(selectedTags)}function createTag(e){var t=200,n=Ti.UI.createView({left:5,top:3,width:1,height:30,backgroundColor:"#E6E6E6",borderWidth:1,borderColor:"#2E2E2E",borderRadius:5,layout:"horizontal"}),r=Ti.UI.createView({left:3,top:0,width:30,height:30}),i=Ti.UI.createImageView({top:0,height:20,width:20,image:hub.API.imagePath("delete.png")});r.add(i),r.addEventListener("click",function(t){removeTag(e)});var s=Ti.UI.createLabel({left:3,text:e,font:{fontSize:18},width:"auto",color:"black",height:30});return ttlWidth=s.toImage().width,ttlWidth>t&&(ttlWidth=t),s.width=ttlWidth,n.width=ttlWidth+r.toImage().width+10,n.add(s,r),n}function PatternMatch(e,t){var n=t.length,r=[];if(t.length>2)for(var i=0,s=e.length;i<s;i++)e[i].substring(0,n).toUpperCase()===t.toUpperCase()&&r.push(e[i]);return r}function CreateAutoCompleteList(e){var t=[];for(var n=0,r=e.length;n<r;n++){var i=Ti.UI.createLabel({top:2,width:"40%",height:34,left:"5%",font:{fontSize:14},color:"#000000",text:e[n]}),s=Ti.UI.createTableViewRow({backgroundColor:"transparent",focusable:!0,height:50,result:e[n]});s.add(i),t.push(s)}tblvAutoComplete.setData(t),tblvAutoComplete.height=t.length*35}function AutoCompleteView(e){selectedTagOptions=hub.API.user.getSelectedOptions("free"),searchArray=e;var t=Ti.UI.createView({top:0});return t.add(searchBarHolder),loadSelectedTags(),t.add(dataHolder),t}hub=require("hub");var selectedTagOptions=[],searchArray=[],dataHolder=Ti.UI.createView({top:50,layout:"Vertical"}),selectedTags=Ti.UI.createView({layout:"horizontal"}),tblvAutoComplete=Ti.UI.createTableView({top:5,width:"100%",backgroundColor:"#EFEFEF",height:0,maxRowHeight:35,minRowHeight:35,allowSelection:!0}),txtAutoComplete=Ti.UI.createSearchBar({top:0,left:3,hintText:"Enter Free Tags",barColor:"#f6f6f6",width:270,value:""});tblvAutoComplete.addEventListener("click",function(e){var t=e.rowData.result;selectedTagOptions.push(t),loadSelectedTags(),clearSearchBar(),CreateAutoCompleteList([])}),dataHolder.add(tblvAutoComplete);var searchBarHolder=Ti.UI.createView({top:0,height:40,width:350,layout:"horizontal"}),cancelButton=Ti.UI.createButton({top:10,borderRadius:1,width:60,height:25,right:3,title:"Cancel"});searchBarHolder.add(txtAutoComplete),searchBarHolder.add(cancelButton),cancelButton.addEventListener("click",function(e){txtAutoComplete.blur()}),txtAutoComplete.addEventListener("change",function(e){var t=e.source.value,n=PatternMatch(searchArray,t);CreateAutoCompleteList(n)}),tblvAutoComplete.addEventListener("click",function(e){txtAutoComplete.value=e.rowData.result}),module.exports=AutoCompleteView